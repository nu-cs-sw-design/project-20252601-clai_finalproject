@startuml
package presentation {
    +class Main {
        +{static}main(args: String[]): void
    }

    +class GameUI {
        -gameState: GameStateLayer
        -localizedMessages: ResourceBundle

        +GameUI(): void

        +handleSetupGame(): void
        -chooseLanguage(): void
        -chooseGame(): void
        -chooseNumberOfPlayers(): void

        -runDisplayLoop(): void
        -promptNextMove(): void
        -handleDisplayTurnEndResult(): void

        -handleShowEndGame(): void
    }
}

package domain {
    +class GameStateLayer {
        -gameLogicLayer: GameLogicLayer
        -currentPlayerTurn: int
        -currentPlayerNumberOfTurns: int

        -attackQueue: List<Integer>
        -attackCounter: int
        -numberOfAttacks: int
        -attacked: boolean

        -isReversed: boolean
        -rand: Random

        -deck: GameDeck
        -turnTracker: int[]
        -numberOfPlayers: int

        -{static}{final} PLAYER_HAND_EMPTY_EXCEPTION: String
        -{static}{final} INVALID_PLAYER_INDEX_EXCEPTION: String
        -{static}{final} INVALID_GAME_TYPE_EXCEPTION: String
        -{static}{final} NO_PLAYERS_EXCEPTION: String
        -{static}{final} OUT_OF_BOUNDS_PLAYER_INDEX_EXCEPTION: String
        -{static}{final} PLAYER_DEAD_EXCEPTION: String
        -{static}{final} CARD_INDEX_OUT_OF_BOUNDS_EXCEPTION: String
        -{static}{final} CARD_TYPE_NOT_FOUND_EXCEPTION: String
        -{static}{final} INVALID_NUMBER_OF_PLAYERS_EXCEPTION: String
        -{static}{final} NUMBER_OF_TURNS_OUT_OF_BOUNDS_EXCEPTION: String


        +GameStateLayer(): void
        ~setGameGameType(gameSelection: GameType): boolean
        ~setNumberOfPlayers(playerNum: int): boolean
        ~getNumCardsInHand(playerID: int): int

        +getPossibleMoves(playerID: int): String
        +playCard(playerID: int, card: CardStrategy): String
        +determinePlayEffects(): String
        +nextMove(): String

        -updateGameState(): void

        -checkValidPlayerIndex(playerIndex: int): boolean

        -stealRandomCard(playerToStealFrom: int): Card
        -stealCard(card: CardStrategy, playerToStealFrom: int): boolean

        -selectRandomPlayer(): Player
        -getDeck(): Deck
        -incrementPlayerTurn(): void
        -incrementAttackCounter(): void
        -setAttackCounter(playerIndex: int): void
        -getPlayerAtIndex(playerIndex: int): Player

        -addAttacks(): void
        -addAttackQueue(attack: int): void
        -removeAttackQueue(): int
        -isAttackQueueEmpty(): boolean

        -setNumberOfTurns(): void
        -getPlayerTurn(): int
        -checkNumberOfAlivePlayers(): int
        -setCurrentPlayerNumberOfTurns(numberOfTurns: int): void
        -decrementNumberOfTurns(): void
        -getNumberOfTurns(): int
        -getDeckSize(): int
        -drawCard(): Card
        -getCardAtIndex(cardIndex: int): Card
        -removeCardFromHand(playerIndex: int, card: CardStrategy)
        -getIndexOfCardFromHand(playerIndex: int, card: CardStrategy)
        -addCardToHand(card: Card): void
        -checkIfPlayerDead(playerIndex: int): boolean
        -checkIfPlayerHasCard(playerIndex: int, card: CardType): boolean
        -getHandSize(playerIndex: int): int
        -getIsReversed(): boolean
        -setCurrentPlayerTurn(turn: int): void

        -checkCardOutOfBoundsIndexed(cardIndex: int, playerIndex: int): boolean
        -checkUserOutOfBounds(userIndex: int): boolean
        -checkDeckHasOneCardOrLess(): boolean
        -checkPlayerHandEmpty(player: Player): boolean
        -checkInvalidNumberOfPlayers(numPlayers: int): boolean

        -checkIfNumberOfTurnsOutOfBounds(): boolean
        -checkIfNumberOfTurnsIsZero(): boolean
    }
    +class Player {
        -playerID: int
        -numTurnsRemaining: int
        -rand: Random
        -isCursed: boolean
        -isDead: boolean

        -{static}{final} MUST_ADD_DEFUSE_CARD_EXCEPTION: String
        -{static}{final} INVALID_INDEX_EXCEPTION: String
        -{static}{final} NO_CARD_FOUND_EXCEPTION: String

        ~Player(playerID: int, instantiator: Instantiator): void
        ~getPlayerID(): int
        ~getIsDead(): boolean
        ~setIsDead(): void
        ~getIsCursed(): boolean
        ~setCursed(isCursed: boolean): void
    }
    +abstract DeckInitializationStrategy {
        +{abstract}generateGameDeck(): Card[]
    }
    +class ExplodingKittensDeck {
        +generateGameDeck(): Card[]
    }
    +class ImplodingKittensDeck {
        +generateGameDeck(): Card[]
    }
    +class StreakingKittensDeck {
        +generateGameDeck(): Card[]
    }


    +class GameDeck {
        -availableCards: Card[]
        -playerHands: Map<int, Card>
        -initializationStrategy: DeckInitializationStrategy

        -{static}{final} DECK_FULL_EXECEPTION: string
        -{static}{final} DRAW_FROM_EMPTY_DECK_EXCEPTION: string
        -{static}{final} NEGATIVE_INDEX_EXCEPTION: string
        -{static}{final} INDEX_GREATER_THAN_DECK_SIZE_EXCEPTION: string
        -{static}{final} MISMATCH_ORDER_SIZE_EXCEPTION: string
        -{static}{final} INDEX_OUT_OF_RANGE_EXCEPTION: string

        +GameDeck(numPlayers: int): boolean
        -initializeDeck(): boolean
        -shuffleDeck(numTimes: int): boolean
        -shuffleHand(numTimes: int): boolean

        ~drawCard(playerNum: int, fromBottom: boolean): Card
        ~insertCard(playerID: int, card: CardStrategy, numberOfCards: int, bottom: boolean): boolean
        ~removeBombs(): int

        ~getCardTypeAtDeckIndex(index: int): CardType
        ~getPlayerHand(playerID: int): Card[];
        ~reorderDeckCards(newOrderIndices: int[], cardsToReorder: List<Card>): void

        ~getNumCardsInHand(playerID: int): int

        -addedOutOfBounds(numberOfCards: int): boolean
        -checkIfExplodingKitten(index: int): boolean
        -checkIfIndexOutOfRange(index: int): boolean
    }

    +enum GameType {
        NONE,
        EXPLODING_KITTENS,
        STREAKING_KITTENS,
        IMPLODING_KITTENS
    }


    +class Card {
        -CardActionStrategy: CardStrategy
        -isMarked: boolean
        -isFacedUp: boolean

        ~Card(cardType: CardStrategy): void
        ~getCardStrategy(): CardStrategy
        ~markCard(): void
        ~checkIfMarked(): boolean
        ~setFacedUp(): void
        ~checkIfFacedUp(): void
    }
    +abstract CardStrategy {
        +{abstract}action(playerID: int): void
        +{abstract}returnCardType(): CardType
    }
    +class ExplodingKittenCard {
        +action(playerID: int): void
        +returnCardType(): CardType

        -playExplodingKitten(playerIndex: int): boolean
    }
    +class NopeCard {
        +action(playerID: int): void
        +returnCardType(): CardType

        -playNope(playerIndex: int): void
    }
    +class ShuffleCard {
        +action(playerID: int): void
        +returnCardType(): CardType

        -playShuffle(): void
    }
    +class SwapTopAndBottomCard {
        +action(playerID: int): void
        +returnCardType(): CardType

        -playSwapTopAndBottom(): void
    }
    +enum CardType {
        NOPE,
        DEFUSE,
        ATTACK,
        SHUFFLE,
        SKIP,
        SEE_THE_FUTURE,
        CAT_ONE,
        CAT_TWO,
        CAT_THREE,
        CAT_FOUR,
        EXPLODING_KITTEN,
        STREAKING_KITTEN,
        SWAP_TOP_AND_BOTTOM,
        GARBAGE_COLLECTION,
        CURSE_OF_THE_CAT_BUTT,
        ALTER_THE_FUTURE,
        CATOMIC_BOMB,
        SUPER_SKIP,
        MARK,
        IMPLODING_KITTEN,
        REVERSE,
        FERAL_CAT,
        TARGETED_ATTACK,
        DRAW_FROM_THE_BOTTOM;

        - {final} gameType: GameType
        ~CardType(gameType: GameType): void
    }
}

Main-->GameUI

GameUI-->GameStateLayer
GameStateLayer-->GameDeck

GameDeck-->Card
GameStateLayer-->Player
GameDeck-->DeckInitializationStrategy

ExplodingKittensDeck=--|>DeckInitializationStrategy
ImplodingKittensDeck=--|>DeckInitializationStrategy
StreakingKittensDeck--|>DeckInitializationStrategy

GameStateLayer-->GameType

Card-->CardStrategy

CardStrategy..>CardType

GameStateLayer..>CardStrategy
GameStateLayer..>Card
GameStateLayer..>CardType
GameDeck..>CardType


ExplodingKittenCard--|>CardStrategy
NopeCard--|>CardStrategy
ShuffleCard--|>CardStrategy
SwapTopAndBottomCard--|>CardStrategy


@enduml